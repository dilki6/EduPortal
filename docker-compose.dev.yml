# ============================================
# Docker Compose - Development Override
# ============================================
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up
# ============================================

version: '3.8'

services:
  eduportal:
    build:
      args:
        VITE_API_BASE_URL: http://localhost/api
    
    ports:
      - "80:80"
      - "5000:5000"
      - "11434:11434"
    
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:5000
      - Logging__LogLevel__Default=Debug
      - Logging__LogLevel__Microsoft.AspNetCore=Information
    
    volumes:
      # Development: mount source for hot reload
      - ./service/EduPortal.Api:/app:ro
      - ./web/dist:/var/www/html:ro
      # Persistent data
      - eduportal-data:/data
    
    # Development doesn't need resource limits
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 8G
    
    # Verbose logging for development
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
        max-file: "2"
